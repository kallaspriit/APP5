define(["Util","Navi","Keyboard"],function(e,t,n){var r=function(r,i,o){var a=t.getCurrent(),s=1;if(e.isObject(a)&&e.isObject(a.parameters)&&!e.isUndefined(a.parameters.page)&&(s=parseInt(a.parameters.page,10),(isNaN(s)||1>s)&&(s=1)),r.currentPage=s,r.itemsPerPage=10,r.pageCount=0,r.pageNumbers=[],r.data=null,r.$parent.pagination=[],!e.isUndefined(o.itemsPerPage)){var u=parseInt(o.itemsPerPage,10);u>=1&&(r.itemsPerPage=u)}var l=r.$watch(o.data,function(t){r.data=t,r.pageCount=Math.ceil(e.sizeOf(t)/r.itemsPerPage),r.currentPage>r.pageCount&&(r.currentPage=1),r.$parent.pagination=r.data.slice((r.currentPage-1)*r.itemsPerPage,r.currentPage*r.itemsPerPage),r.pageNumbers=[];for(var n=1;r.pageCount>=n;n++)r.pageNumbers.push(n)},!0);r.showNextPage=function(){var e=Math.min(r.currentPage+1,r.pageCount);t.setUrlParameter("page",e,!0)},r.showPreviousPage=function(){var e=Math.max(r.currentPage-1,1);t.setUrlParameter("page",e,!0)};var c=t.bind(t.Event.PARAMETERS_CHANGED,function(e){r.currentPage=e.parameters.page,r.$parent.pagination=r.data.slice((r.currentPage-1)*r.itemsPerPage,r.currentPage*r.itemsPerPage)}),f=n.bind(n.Event.KEYDOWN,function(e){"RIGHT"===e.info.name?r.showNextPage():"LEFT"===e.info.name&&r.showPreviousPage()});i.bind("$destroy",function(){l(),c.unbind(),f.unbind()})};return[function(){return{scope:!0,restrict:"E",transclude:!0,replace:!0,link:r,templateUrl:"partials/pagination.html"}}]});