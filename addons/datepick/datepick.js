define(["ResourceManager","App","Util","addons/datepick/glDatePicker"],function(e,t,n){var a=function(e){return(10>e.getDate()?"0":"")+e.getDate()+"."+(10>e.getMonth()+1?"0":"")+(e.getMonth()+1)+"."+e.getFullYear()},l=function(e){var t=new Date,n=t.getFullYear(),a=t.getMonth(),l=t.getDate(),i=e.split(".");return 3===i.length&&(l=parseInt(i[0],10),a=parseInt(i[1],10)-1,n=parseInt(i[2],10)),new Date(n,a,l)},i=function(i,r,d){e.loadCss("addons/datepick/glDatePicker.default.css");var o=null,c=null,s=new Date;n.isUndefined(d.ngModel)||(o=i.$watch("model",function(e){n.isString(e)&&(s=l(e),r.val(a(s)))})),window.setTimeout(function(){c=$(r).glDatePicker({onClick:function(e,l,r){var o=a(r);e.val(o),n.isUndefined(d.ngModel)||(i.model=o,t.validate())},selectedDate:s,zIndex:1e4,startDate:new Date(1900,0,1),endDate:new Date}).glDatePicker(!0)},500),r.bind("$destroy",function(){n.isFunction(o)&&o(),null!==c&&$(c.calendar[0]).remove()})};return[function(){return{scope:{model:"=ngModel"},restrict:"E",transclude:!0,replace:!0,link:i,templateUrl:"addons/datepick/datepick.html"}}]});