(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};u=function(e,t,n){return o.readFile(e,function(r,i){var s,o;if(r)throw r;return s=i.toString(),o=y(e,s),c(e,o,function(){return a(e,o,t),n()})})},y=function(e,t){var n,r,i,s,o,u,a,l,c,h;u=t.split("\n"),l=[],s=f(e),i=r=n="",a=function(e,t){return console.log(e),l.push({docsText:e,codeText:t})};for(c=0,h=u.length;c<h;c++)o=u[c],o.match(s.commentMatcher)&&!o.match(s.commentFilter)?(i&&(a(r,n),i=r=n=""),r+=o.replace(s.commentMatcher,"")+"\n"):(i=!0,n+=o+"\n");return a(r,n),l},c=function(e,t,n){var r,i,s,o,u,a;s=f(e),u=x("pygmentize",["-l",s.name,"-f","html","-O","encoding=utf-8,tabsize=2"]),o="",r=function(){var e,n,r;r=[];for(e=0,n=t.length;e<n;e++)a=t[e],r.push(a.codeText);return r}().join(s.codeSplitText),i=function(){var e,n,r;r=[];for(e=0,n=t.length;e<n;e++)a=t[e],r.push(a.docsText);return r}().join(s.docsSplitText),u.stderr.on("data",function(){}),u.stdin.on("error",function(){}),u.stdout.on("data",function(e){if(e)return o+=e}),u.on("exit",function(){var e,r,u,f,l;o=o.replace(p,"").replace(h,""),o===""?e=function(){var e,n,r;r=[];for(e=0,n=t.length;e<n;e++)a=t[e],r.push(d(a.codeText));return r}():e=o.split(s.codeSplitHtml),r=S.makeHtml(i).split(s.docsSplitHtml);for(u=f=0,l=t.length;f<l;u=++f)a=t[u],a.codeHtml=p+e[u]+h,a.docsHtml=r[u];return n()});if(u.stdin.writable)return u.stdin.write(r),u.stdin.end()},d=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},a=function(e,t,n){var r,i,s,u;return i=function(e){return b.join(n.output,b.basename(e,b.extname(e))+".html")},u=b.basename(e),r=i(e),s=n.doccoTemplate({title:u,sections:t,sources:n.sources,path:b,destination:i,css:b.basename(n.css)}),console.log("docco: "+e+" -> "+r),o.writeFileSync(r,s)},o=require("fs"),b=require("path"),S=require("./../vendor/showdown").Showdown,k=require("child_process"),x=k.spawn,i=k.exec,e=require("commander"),l=function(e){var t;return t=b.join(__dirname,"..","resources",e),o.readFileSync(t).toString()},g=JSON.parse(l("languages.json"));for(s in g)m=g[s],m.commentMatcher=RegExp("^\\s*"+m.symbol+"\\s?"),m.commentFilter=/(^#![/]|^\s*#\{)/,m.codeSplitText="\n"+m.symbol+"DIVIDER\n",m.codeSplitHtml=RegExp('\\n*<span\\sclass="c1?">'+m.symbol+"DIVIDER<\\/span>\\n*"),m.docsSplitText="\n#"+m.name+"DOCDIVIDER\n",m.docsSplitHtml=RegExp("<h1>"+m.name+"DOCDIVIDER</h1>");f=function(e){return g[b.extname(e)]},r=function(e,t,n){var i;return n==null&&(n=null),i=parseInt("0777",8),o.mkdir(e,i,function(i){return i?i.code==="ENOENT"?r(b.dirname(e),function(n,i){return n?t(n,i):r(e,t,i)}):t(i,n):t(null,n||e)})},T=function(e){return new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").replace(/'(?=[^<]*%>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');")},p='<div class="highlight"><pre>',h="</pre></div>",C=JSON.parse(o.readFileSync(""+__dirname+"/../package.json")).version,t={template:""+__dirname+"/../resources/docco.jst",css:""+__dirname+"/../resources/docco.css",output:"docs/"},E=function(r){return r==null&&(r=process.argv),e.version(C).usage("[options] <filePattern ...>").option("-c, --css [file]","use a custom css file",t.css).option("-o, --output [path]","use a custom output path",t.output).option("-t, --template [file]","use a custom .jst template",t.template).parse(r).name="docco",e.args.length?n(e.args.slice(),e):console.log(e.helpInformation())},n=function(e,n,i){var s,a,l,c,h,p,d,v,m,g,y;n==null&&(n={}),i==null&&(i=null),s={};for(l in t)d=t[l],s[l]=t[l];if(l in t)for(l in n)d=n[l],s[l]=d;h=[];for(v=0,g=e.length;v<g;v++)p=e[v],h=h.concat(w(p));s.sources=h.filter(function(e){return f(e)}).sort();for(m=0,y=h.length;m<y;m++)c=h[m],A.call(s.sources,c)<0&&console.log("docco: skipped unknown type ("+c+")");return s.doccoTemplate=T(o.readFileSync(s.template).toString()),a=o.readFileSync(s.css).toString(),r(s.output,function(){var e,t;return o.writeFileSync(b.join(s.output,b.basename(s.css)),a),e=s.sources.slice(),t=function(){i!=null&&!e.length&&i();if(e.length)return u(e.shift(),s,t)},t()})},w=function(e){var t,n,r,i,s;return e.match(/([\*\?])/)?(s=b.basename(e).replace(/\./g,"\\$&").replace(/\*/,".*").replace(/\?/,"."),i=new RegExp("^("+s+")$"),n=b.dirname(e),r=o.readdirSync(n),function(){var e,s,o;o=[];for(e=0,s=r.length;e<s;e++)t=r[e],t.match(i)&&o.push(b.join(n,t));return o}()):e},L={run:E,document:n,parse:y,resolveSource:w,version:C,defaults:t,languages:g,ensureDirectory:r};for(v in L)N=L[v],exports[v]=N}).call(this);