define(["EventEmitter","Util"],function(e,t){var n=function(){e.call(this),this._buttonDown=[]};return n.prototype=Object.create(e.prototype),n.prototype.Event={MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEMOVE:"mousemove"},n.prototype.Button={LEFT:0,MIDDLE:1,RIGHT:2},n.MouseEvent=function(e,t,n,r,i,o,a,s,l,u,c,p){this.type=e,this.button=t,this.offsetX=n,this.offsetY=r,this.clientX=i,this.clientY=o,this.screenX=a,this.screenY=s,this.pageX=l,this.pageY=u,this.target=c,this.original=p},n.prototype.init=function(){var e=this;return $(document.body).bind("mousedown mouseup mousemove",function(t){e.consume(e.generate(t.type,t.button,t.offsetX,t.offsetY,t.clientX,t.clientY,t.screenX,t.screenY,t.pageX,t.pageY,t.target,t.originalEvent))}),this},n.prototype.generate=function(e,r,i,o,a,s,l,u,c,p,f,d){return r=t.isNumber(r)?r:0,a=t.isNumber(a)?a:i,s=t.isNumber(s)?s:o,l=t.isNumber(l)?l:i,u=t.isNumber(u)?u:o,c=t.isNumber(c)?c:i,p=t.isNumber(p)?p:o,d=t.isUndefined(d)?null:d,f=t.isUndefined(f)?null:f,new n.MouseEvent(e,r,i,o,a,s,l,u,c,p,f,d)},n.prototype.consume=function(e){if(e.type===this.Event.MOUSEDOWN)t.contains(this._buttonDown,e.button)||this._buttonDown.push(e.button);else if(e.type===this.Event.MOUSEUP)t.contains(this._buttonDown,e.button)&&t.remove(e.button,this._buttonDown);else if(e.type!==this.Event.MOUSEMOVE)throw Error('Unexpected mouse event type "'+e.type+'"');this.emit({type:e.type,info:e})},n.prototype.isButtonDown=function(e){return t.contains(this._buttonDown,e)},new n});