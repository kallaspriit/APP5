define(["Bindable","Util"],function(t,e){var n=function(){this._buttonDown=[]};return n.prototype=new t,n.prototype.Event={MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEMOVE:"mousemove"},n.prototype.Button={LEFT:0,MIDDLE:1,RIGHT:2},n.MouseEvent=function(t,e,n,r,i,o,a,s,u,c,l,f){this.type=t,this.button=e,this.offsetX=n,this.offsetY=r,this.clientX=i,this.clientY=o,this.screenX=a,this.screenY=s,this.pageX=u,this.pageY=c,this.target=l,this.original=f},n.prototype.init=function(){var t=this;return $(document.body).bind("mousedown mouseup mousemove",function(e){t.consume(t.generate(e.type,e.button,e.offsetX,e.offsetY,e.clientX,e.clientY,e.screenX,e.screenY,e.pageX,e.pageY,e.target,e.originalEvent))}),this},n.prototype.generate=function(t,r,i,o,a,s,u,c,l,f,h,p){return r=e.isNumber(r)?r:0,a=e.isNumber(a)?a:i,s=e.isNumber(s)?s:o,u=e.isNumber(u)?u:i,c=e.isNumber(c)?c:o,l=e.isNumber(l)?l:i,f=e.isNumber(f)?f:o,p=e.isUndefined(p)?null:p,h=e.isUndefined(h)?null:h,new n.MouseEvent(t,r,i,o,a,s,u,c,l,f,h,p)},n.prototype.consume=function(t){if(t.type===this.Event.MOUSEDOWN)e.contains(this._buttonDown,t.button)||this._buttonDown.push(t.button);else if(t.type===this.Event.MOUSEUP)e.contains(this._buttonDown,t.button)&&e.remove(t.button,this._buttonDown);else if(t.type!==this.Event.MOUSEMOVE)throw Error('Unexpected mouse event type "'+t.type+'"');this.fire({type:t.type,info:t})},n.prototype.isButtonDown=function(t){return e.contains(this._buttonDown,t)},new n});