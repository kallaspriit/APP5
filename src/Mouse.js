define(["Bindable","Util"],function(e,t){var n=function(){this._buttonDown=[]};return n.prototype=new e,n.prototype.Event={MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEMOVE:"mousemove"},n.prototype.Button={LEFT:0,MIDDLE:1,RIGHT:2},n.MouseEvent=function(e,t,n,r,i,o,a,s,u,l,c,f){this.type=e,this.button=t,this.offsetX=n,this.offsetY=r,this.clientX=i,this.clientY=o,this.screenX=a,this.screenY=s,this.pageX=u,this.pageY=l,this.target=c,this.original=f},n.prototype.init=function(){var e=this;return $(document.body).bind("mousedown mouseup mousemove",function(t){e.consume(e.generate(t.type,t.button,t.offsetX,t.offsetY,t.clientX,t.clientY,t.screenX,t.screenY,t.pageX,t.pageY,t.target,t.originalEvent))}),this},n.prototype.generate=function(e,r,i,o,a,s,u,l,c,f,h,p){return r=t.isNumber(r)?r:0,a=t.isNumber(a)?a:i,s=t.isNumber(s)?s:o,u=t.isNumber(u)?u:i,l=t.isNumber(l)?l:o,c=t.isNumber(c)?c:i,f=t.isNumber(f)?f:o,p=t.isUndefined(p)?null:p,h=t.isUndefined(h)?null:h,new n.MouseEvent(e,r,i,o,a,s,u,l,c,f,h,p)},n.prototype.consume=function(e){if(e.type===this.Event.MOUSEDOWN)t.contains(this._buttonDown,e.button)||this._buttonDown.push(e.button);else if(e.type===this.Event.MOUSEUP)t.contains(this._buttonDown,e.button)&&t.remove(e.button,this._buttonDown);else if(e.type!==this.Event.MOUSEMOVE)throw Error('Unexpected mouse event type "'+e.type+'"');this.fire({type:e.type,info:e})},n.prototype.isButtonDown=function(e){return t.contains(this._buttonDown,e)},new n});