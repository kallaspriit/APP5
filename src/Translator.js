define(["Bindable","Util","underscore"],function(t,e,n){var r=function(){this._language=null,this._translations={}};return r.prototype=new t,r.prototype.Event={LANGUAGE_CHANGED:"language-changed"},r.prototype.init=function(t,n){return e.isObject(t)&&this.setTranslations(t),e.isString(n)&&this.setLanguage(n),this},r.prototype.setTranslations=function(t){return this._translations=t,this},r.prototype.appendTranslations=function(t){return e.extend(this._translations,t),this},r.prototype.addTranslation=function(t,n,r){return e.isObject(this._translations[t])||(this._translations[t]={}),this._translations[t][n]=r,this},r.prototype.setLanguage=function(t){var e=this._language;return this._language=t,this.fire({type:this.Event.LANGUAGE_CHANGED,newLanguage:t,previousLanguage:e}),this},r.prototype.getLanguage=function(){return this._language},r.prototype.getLanguages=function(t){t=e.isBoolean(t)?t:!1;var n,r,i=[];for(n in this._translations){for(r in this._translations[n])t?i.push({id:r,name:this.has("lang."+r)?this.translate("lang."+r):r}):i.push(r);break}return i},r.prototype.has=function(t){return e.isString(t)&&e.isObject(this._translations[t])&&e.isString(this._translations[t][this._language])?!0:!1},r.prototype.translate=function(t){if(!e.isString(t)||!e.isObject(this._translations[t])||!e.isString(this._translations[t][this._language]))return t;var r=n.toArray(arguments);return r[0]=this._translations[t][this._language],e.sprintf.apply(e,r)},new r});